(B) Add `citation_confidence` and `citation_status` fields to `/src/types/chat.ts` citation model for downstream trust controls. +alignment +types +stability
(B) Add a post-response legal accuracy check in `/src/lib/ai/chat-service.ts` that appends a caution block when no valid citations are detected for legal-analysis prompts. +alignment +accuracy +safety
(B) Replace `securityLevel: 'loose'` with `securityLevel: 'strict'` in `/src/components/chat/MermaidDiagram.tsx`. +security +stability +alignment
(B) Disable Mermaid `htmlLabels` in `/src/components/chat/MermaidDiagram.tsx` to reduce scriptable SVG surface area. +security +stability +alignment
(B) Sanitize rendered SVG strings before `dangerouslySetInnerHTML` in Mermaid, Graphviz, and TreeView components. +security +stability +hardening
(B) Remove `dangerouslySetInnerHTML` usage in `/src/components/chat/HistoryDialog.tsx` by rendering highlighted spans with React nodes. +security +stability +hardening
(B) Escape message content used in Graphviz dot labels in `/src/lib/chat-tree.ts` for `<`, `>`, `&`, and backslashes. +security +stability +hardening
(B) Replace naive `strip_html_tags` in `/src-tauri/src/tools.rs` with a parser-based extractor that removes script and style content safely. +stability +security +performance
(B) Validate and normalize URLs in `fetch_url` command in `/src-tauri/src/tools.rs` before issuing network requests. +security +stability +hardening
(B) Add response body size limits to `fetch_url` in `/src-tauri/src/tools.rs` to prevent memory spikes on large pages. +performance +stability +hardening
(B) Add request timeouts to all provider and tool HTTP clients in `/src-tauri/src/providers.rs` and `/src-tauri/src/tools.rs`. +stability +performance +network
(B) Treat non-2xx statuses as offline in `health_check` in `/src-tauri/src/tools.rs`. +stability +bugfix +network
(B) Add exponential backoff retry for transient provider failures in `/src-tauri/src/providers.rs`. +stability +performance +network
(B) Propagate structured error codes from Rust `AppError` to frontend toast handling for actionable recovery paths. +dx +stability +errorhandling
(B) Add `AbortController` support in `/src/lib/ai/chat-service.ts` and cancel in-flight requests when user sends a new turn. +performance +stability +ux
(B) Reduce streaming re-render cost in `ChatInterface` by buffering chunks and committing updates at a fixed interval. +performance +memory +stability
(B) Cap model context sent to remote providers in `/src/lib/ai/chat-service.ts` using token-budgeted history pruning. +performance +cost +stability
(B) Add conversation summarization checkpoints for old turns to reduce memory pressure while preserving context quality. +performance +memory +alignment
(B) Process long `/analyze-document` and `/extract-entities` inputs in chunks in `/src/lib/nlp/` modules to avoid high peak memory. +performance +memory +stability
(B) Move heavy NLP command processing to a Web Worker and stream partial results back to UI. +performance +memory +stability
(B) Add hard text-length guards to slash commands in `/src/lib/commands/command-processor.ts` with user-facing truncation errors. +stability +performance +ux
(B) Implement real model download and cache pipeline for ONNX assets in `/src/lib/ml/model-manager.ts` and `/src-tauri/src/ml.rs`. +feature +performance +alignment
(B) Hide local model commands when ONNX runtime is unavailable and replace with explicit capability errors. +stability +ux +alignment
(B) Remove misleading “model downloaded” localStorage-only state in `/src/lib/ml/model-manager.ts` and key status off verified file presence. +stability +bugfix +alignment
(B) Fix TOML section parsing regex in `/src/lib/toml.ts` so `[profile]` and other sections parse correctly. +stability +bugfix +config
(B) Add schema validation for parsed TOML before calling `updateSettings` in `/src/components/ConfigDialog.tsx`. +stability +types +config
(B) Emit a `junas-settings-change` event inside `StorageManager.saveSettings` so snippet-dependent UI updates without reload. +dx +stability +ui
(B) Add high-signal local observability events for provider latency, tool latency, and failure rates in chat flow. +dx +observability +stability
(B) Persist recent error events to local app data for offline debugging with no cloud telemetry. +dx +observability +localfirst
(B) Add `npm run typecheck` script and fail CI on TypeScript errors. +dx +ci +quality
(B) Add `npm run lint` to CI build workflow before packaging artifacts. +dx +ci +quality
(B) Add `cargo check --all-targets` and `cargo clippy -D warnings` to CI build workflow. +dx +ci +quality
(B) Add fast unit tests for command parsing, TOML parsing, citation extraction, and history persistence. +dx +testing +quality
(B) Add a smoke integration test that sends a prompt, streams a response, persists chat state, and reloads history. +dx +testing +stability
(B) Disable Tauri `devtools` feature in release builds by removing unconditional `features = ["devtools"]` from `/src-tauri/Cargo.toml`. +security +stability +hardening
(B) Tighten Tauri CSP in `/src-tauri/tauri.conf.json` by removing `script-src 'unsafe-inline'` after diagram rendering hardening lands. +security +hardening +stability
